{
    "swagger": "2.0",
    "info": {
        "description": "API complète pour le système de livraison ILEX",
        "title": "ILEX Backend API",
        "termsOfService": "http://swagger.io/terms/",
        "contact": {
            "name": "API Support",
            "url": "http://www.swagger.io/support",
            "email": "support@swagger.io"
        },
        "license": {
            "name": "MIT",
            "url": "https://opensource.org/licenses/MIT"
        },
        "version": "1.0"
    },
    "host": "127.0.0.1:3000",
    "basePath": "/api/v1",
    "paths": {
        "/auth/profile": {
            "get": {
                "security": [
                    {
                        "BearerAuth": []
                    }
                ],
                "description": "Récupère les informations du profil de l'utilisateur authentifié",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "User Profile"
                ],
                "summary": "Récupérer le profil utilisateur",
                "responses": {
                    "200": {
                        "description": "Profil utilisateur",
                        "schema": {
                            "$ref": "#/definitions/models.UserProfileResponse"
                        }
                    },
                    "401": {
                        "description": "Non authentifié",
                        "schema": {
                            "$ref": "#/definitions/models.ErrorResponse"
                        }
                    },
                    "404": {
                        "description": "Utilisateur non trouvé",
                        "schema": {
                            "$ref": "#/definitions/models.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/auth/profile/picture": {
            "post": {
                "security": [
                    {
                        "BearerAuth": []
                    }
                ],
                "description": "Upload une image de profil vers Cloudinary et met à jour le profil utilisateur",
                "consumes": [
                    "multipart/form-data"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "User Profile"
                ],
                "summary": "Uploader une photo de profil",
                "parameters": [
                    {
                        "type": "file",
                        "description": "Image de profil (JPG, PNG, GIF, WEBP - max 10MB)",
                        "name": "file",
                        "in": "formData",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Upload réussi",
                        "schema": {
                            "$ref": "#/definitions/models.ProfilePictureResponse"
                        }
                    },
                    "400": {
                        "description": "Erreur de validation",
                        "schema": {
                            "$ref": "#/definitions/models.ErrorResponse"
                        }
                    },
                    "401": {
                        "description": "Non authentifié",
                        "schema": {
                            "$ref": "#/definitions/models.ErrorResponse"
                        }
                    },
                    "502": {
                        "description": "Erreur Cloudinary",
                        "schema": {
                            "$ref": "#/definitions/models.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/auth/send-otp": {
            "post": {
                "description": "Envoie un code OTP par WhatsApp pour l'authentification",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Authentication"
                ],
                "summary": "Envoyer un code OTP",
                "parameters": [
                    {
                        "description": "Données de la requête OTP",
                        "name": "request",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/models.SendOTPRequest"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Code OTP envoyé avec succès",
                        "schema": {
                            "$ref": "#/definitions/models.OTPResponse"
                        }
                    },
                    "400": {
                        "description": "Erreur de validation",
                        "schema": {
                            "$ref": "#/definitions/models.ErrorResponse"
                        }
                    },
                    "500": {
                        "description": "Erreur serveur",
                        "schema": {
                            "$ref": "#/definitions/models.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/auth/verify-otp": {
            "post": {
                "description": "Vérifie le code OTP et retourne un token JWT si valide",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Authentication"
                ],
                "summary": "Vérifier un code OTP",
                "parameters": [
                    {
                        "description": "Code OTP à vérifier",
                        "name": "request",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/models.VerifyOTPRequest"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Authentification réussie",
                        "schema": {
                            "$ref": "#/definitions/models.AuthResponse"
                        }
                    },
                    "400": {
                        "description": "Code OTP invalide",
                        "schema": {
                            "$ref": "#/definitions/models.ErrorResponse"
                        }
                    },
                    "500": {
                        "description": "Erreur serveur",
                        "schema": {
                            "$ref": "#/definitions/models.ErrorResponse"
                        }
                    }
                }
            }
        }
    },
    "definitions": {
        "models.AuthResponse": {
            "type": "object",
            "properties": {
                "expiresAt": {
                    "type": "string"
                },
                "refreshToken": {
                    "type": "string"
                },
                "token": {
                    "type": "string"
                },
                "user": {
                    "$ref": "#/definitions/models.UserResponse"
                }
            }
        },
        "models.DriverStatus": {
            "type": "string",
            "enum": [
                "OFFLINE",
                "ONLINE",
                "BUSY",
                "AVAILABLE"
            ],
            "x-enum-varnames": [
                "DriverStatusOffline",
                "DriverStatusOnline",
                "DriverStatusBusy",
                "DriverStatusAvailable"
            ]
        },
        "models.ErrorResponse": {
            "type": "object",
            "properties": {
                "details": {
                    "type": "string",
                    "example": "Détails supplémentaires"
                },
                "error": {
                    "type": "string",
                    "example": "Message d'erreur"
                }
            }
        },
        "models.OTPResponse": {
            "type": "object",
            "properties": {
                "expiresIn": {
                    "type": "string",
                    "example": "5 minutes"
                },
                "message": {
                    "type": "string",
                    "example": "OTP sent successfully"
                }
            }
        },
        "models.ProfilePictureResponse": {
            "type": "object",
            "properties": {
                "message": {
                    "type": "string",
                    "example": "Photo de profil uploadée avec succès"
                },
                "profilePictureUrl": {
                    "type": "string",
                    "example": "https://res.cloudinary.com/livraison/image/upload/v1234567890/photo_profil_livraison/abc123.jpg"
                },
                "publicId": {
                    "type": "string",
                    "example": "photo_profil_livraison/abc123"
                },
                "url": {
                    "type": "string",
                    "example": "https://res.cloudinary.com/livraison/image/upload/v1234567890/photo_profil_livraison/abc123.jpg"
                },
                "user": {
                    "$ref": "#/definitions/models.User"
                }
            }
        },
        "models.SendOTPRequest": {
            "type": "object",
            "required": [
                "phone"
            ],
            "properties": {
                "phone": {
                    "type": "string",
                    "maxLength": 15,
                    "minLength": 8
                }
            }
        },
        "models.User": {
            "type": "object",
            "required": [
                "id",
                "phone",
                "role"
            ],
            "properties": {
                "address": {
                    "type": "string"
                },
                "cni_recto": {
                    "type": "string"
                },
                "cni_verso": {
                    "type": "string"
                },
                "createdAt": {
                    "type": "string"
                },
                "dateOfBirth": {
                    "type": "string"
                },
                "driverStatus": {
                    "$ref": "#/definitions/models.DriverStatus"
                },
                "email": {
                    "type": "string"
                },
                "firstName": {
                    "type": "string"
                },
                "id": {
                    "type": "string"
                },
                "is_driver_complete": {
                    "type": "boolean"
                },
                "is_driver_vehicule_complete": {
                    "type": "boolean"
                },
                "is_profile_completed": {
                    "type": "boolean"
                },
                "lastKnownLat": {
                    "type": "number",
                    "maximum": 90,
                    "minimum": -90
                },
                "lastKnownLng": {
                    "type": "number",
                    "maximum": 180,
                    "minimum": -180
                },
                "lastName": {
                    "type": "string"
                },
                "lastSeenAt": {
                    "type": "string"
                },
                "lieuResidence": {
                    "type": "string"
                },
                "permis_recto": {
                    "type": "string"
                },
                "permis_verso": {
                    "type": "string"
                },
                "phone": {
                    "type": "string",
                    "maxLength": 15,
                    "minLength": 8
                },
                "profilePictureId": {
                    "type": "string"
                },
                "referredById": {
                    "type": "string"
                },
                "role": {
                    "$ref": "#/definitions/models.UserRole"
                },
                "updatedAt": {
                    "type": "string"
                }
            }
        },
        "models.UserProfileResponse": {
            "type": "object",
            "properties": {
                "createdAt": {
                    "type": "string",
                    "example": "2024-01-15T10:30:00Z"
                },
                "email": {
                    "type": "string",
                    "example": "john.doe@example.com"
                },
                "firstName": {
                    "type": "string",
                    "example": "John"
                },
                "id": {
                    "type": "string",
                    "example": "user_123"
                },
                "isAdmin": {
                    "type": "boolean",
                    "example": false
                },
                "isDriver": {
                    "type": "boolean",
                    "example": false
                },
                "lastName": {
                    "type": "string",
                    "example": "Doe"
                },
                "phone": {
                    "type": "string",
                    "example": "+2250173226070"
                },
                "profilePictureUrl": {
                    "type": "string",
                    "example": "https://res.cloudinary.com/livraison/image/upload/v1234567890/photo_profil_livraison/abc123.jpg"
                },
                "updatedAt": {
                    "type": "string",
                    "example": "2024-01-15T10:30:00Z"
                }
            }
        },
        "models.UserResponse": {
            "type": "object",
            "properties": {
                "address": {
                    "type": "string"
                },
                "createdAt": {
                    "type": "string"
                },
                "dateOfBirth": {
                    "type": "string"
                },
                "driverStatus": {
                    "$ref": "#/definitions/models.DriverStatus"
                },
                "email": {
                    "type": "string"
                },
                "firstName": {
                    "type": "string"
                },
                "id": {
                    "type": "string"
                },
                "is_driver_complete": {
                    "type": "boolean"
                },
                "is_driver_vehicule_complete": {
                    "type": "boolean"
                },
                "is_profile_completed": {
                    "type": "boolean"
                },
                "lastKnownLat": {
                    "type": "number"
                },
                "lastKnownLng": {
                    "type": "number"
                },
                "lastName": {
                    "type": "string"
                },
                "lastSeenAt": {
                    "type": "string"
                },
                "lieuResidence": {
                    "type": "string"
                },
                "phone": {
                    "type": "string"
                },
                "profilePictureId": {
                    "type": "string"
                },
                "referredById": {
                    "type": "string"
                },
                "role": {
                    "$ref": "#/definitions/models.UserRole"
                },
                "updatedAt": {
                    "type": "string"
                }
            }
        },
        "models.UserRole": {
            "type": "string",
            "enum": [
                "CLIENT",
                "LIVREUR",
                "ADMIN",
                "GESTIONNAIRE",
                "MARKETING"
            ],
            "x-enum-varnames": [
                "UserRoleClient",
                "UserRoleLivreur",
                "UserRoleAdmin",
                "UserRoleGestionnaire",
                "UserRoleMarketing"
            ]
        },
        "models.VerifyOTPRequest": {
            "type": "object",
            "required": [
                "code",
                "phone"
            ],
            "properties": {
                "code": {
                    "type": "string"
                },
                "phone": {
                    "type": "string",
                    "maxLength": 15,
                    "minLength": 8
                }
            }
        }
    },
    "securityDefinitions": {
        "BearerAuth": {
            "description": "Type \"Bearer\" followed by a space and JWT token.",
            "type": "apiKey",
            "name": "Authorization",
            "in": "header"
        }
    }
}